# âš•ï¸ Surgical Complication AI Assistant

> Intelligent RAG-powered clinical decision support system for surgical complication management using Gemini 2.0 Flash-Lite

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.29.0-FF4B4B.svg)](https://streamlit.io)
[![LangChain](https://img.shields.io/badge/LangChain-0.1.0-green.svg)](https://python.langchain.com/)

## ğŸŒŸ Overview

The **Surgical Complication AI Assistant** is an advanced clinical decision support tool that leverages Retrieval-Augmented Generation (RAG) architecture to provide evidence-based, structured information about surgical complications. Built with Gemini 2.0 Flash-Lite and LangChain, it delivers instant access to critical clinical protocols for diagnosis, risk assessment, and management of post-operative complications.

### ğŸ¯ Key Features

- **ğŸ” Intelligent Search**: Instant protocol retrieval by surgery or complication name
- **ğŸ“š Knowledge Base Explorer**: Browse comprehensive surgical protocols via structured dropdowns
- **ğŸ’¬ AI-Powered Q&A**: Natural language queries with context-aware, structured responses
- **ğŸ“‹ Structured Clinical Output**: Organized by Diagnosis, Etiology, Risk Factors, and Management
- **âš¡ Fast & Accurate**: Powered by Gemini 2.0 Flash-Lite for sub-2-second responses
- **ğŸ” Secure**: API keys managed via environment variables
- **ğŸ¨ User-Friendly UI**: Clean, intuitive Streamlit interface with tab-based navigation

## ğŸ—ï¸ System Architecture
```
User Query
    â†“
Knowledge Base (JSON)
    â†“
Document Preparation & Chunking
    â†“
Vector Embeddings (HuggingFace: all-MiniLM-L6-v2)
    â†“
FAISS Vector Store
    â†“
Semantic Retrieval (Top 3 Similar Docs)
    â†“
RAG Chain (LangChain LCEL)
    â†“
Gemini 2.0 Flash-Lite (LLM)
    â†“
Structured Clinical Response
```

## ğŸ› ï¸ Technology Stack

| Component | Technology | Purpose |
|-----------|-----------|---------|
| **LLM** | Gemini 2.0 Flash-Lite | Fast inference, structured output generation |
| **Embeddings** | HuggingFace (all-MiniLM-L6-v2) | Free local embeddings, 384-dimensional vectors |
| **Vector Store** | FAISS (CPU) | Efficient similarity search |
| **Framework** | LangChain | RAG pipeline orchestration |
| **UI** | Streamlit | Interactive web interface |
| **Language** | Python 3.8+ | Core development |

## ğŸ“‹ Prerequisites

- Python 3.8 or higher
- Google Gemini API key ([Get it free](https://makersuite.google.com/app/apikey))
- 2GB+ RAM (for embedding model)

## ğŸš€ Quick Start

### 1. Clone the Repository
```bash
git clone https://github.com/ppd05/surgical-complication-assistant.git
cd surgical-complication-assistant
```

### 2. Create Virtual Environment

**Windows:**
```bash
python -m venv venv
venv\Scripts\activate
```

**macOS/Linux:**
```bash
python3 -m venv venv
source venv/bin/activate
```

### 3. Install Dependencies
```bash
pip install -r requirements.txt
```

*First installation takes 2-3 minutes (downloads embedding model)*

### 4. Configure API Key
```bash
# Copy example file
cp .env.example .env

# Edit .env and add your Gemini API key
# GOOGLE_API_KEY=your_actual_api_key_here
```

### 5. Run the Application
```bash
streamlit run streamlit_app.py
```

The app will open at `http://localhost:8501`

## ğŸ“– Usage Guide

### Mode 1: Instant Search (Fast)

1. Select **"ğŸ’¡ Instant Search (Fast)"** mode
2. Type any keyword (e.g., "anastomotic leak", "bile duct injury")
3. Instantly view the matching protocol

### Mode 2: Protocol Explorer (Dropdowns)

1. Select **"ğŸ“š Protocol Explorer (Dropdowns)"** mode
2. Choose surgery from first dropdown
3. Select specific complication from second dropdown
4. View detailed protocol

### Mode 3: AI Assistant Chat

1. Navigate to **"ğŸ’¬ AI Assistant Chat"** tab
2. Type your clinical question in natural language
3. Click **"Generate Structured Clinical Response"**
4. Receive formatted answer with sections:
   - Diagnosis & Presentation
   - Etiology & Risk Factors
   - Management Protocol
   - Source documents used

## ğŸ“Š Clinical Information Structure

Each protocol includes:

1. **Risk Factors**: Pre-existing conditions and procedural factors
2. **Etiology**: Mechanism of injury and pathophysiology
3. **Diagnostic Criteria**: Signs, symptoms, and diagnostic tests
4. **Management Protocol**: Step-by-step clinical management
5. **References**: Links to treatment guidelines

## ğŸ—‚ï¸ Project Structure
```
surgical-complication-assistant/
â”‚
â”œâ”€â”€ src/                          # Core application modules
â”‚   â”œâ”€â”€ __init__.py              # Package initializer
â”‚   â”œâ”€â”€ ai_engine.py             # LLM and RAG chain setup
â”‚   â”œâ”€â”€ data_loader.py           # Knowledge base loading
â”‚   â””â”€â”€ vectorstore_manager.py   # FAISS vector store management
â”‚
â”œâ”€â”€ data/                         # Knowledge base
â”‚   â””â”€â”€ surgical_knowledge.json  # Surgical protocols database
â”‚
â”œâ”€â”€ .streamlit/                   # Streamlit configuration
â”‚   â””â”€â”€ config.toml              # UI theme and settings
â”‚
â”œâ”€â”€ streamlit_app.py             # Main application entry point
â”œâ”€â”€ requirements.txt             # Python dependencies
â”œâ”€â”€ .env.example                 # Environment variables template
â”œâ”€â”€ .gitignore                   # Git ignore rules
â””â”€â”€ README.md                    # This file
```

## ğŸ”§ Configuration

### Environment Variables

Create a `.env` file:
```env
GOOGLE_API_KEY=your_gemini_api_key_here
```

### Knowledge Base Format

The `surgical_knowledge.json` follows this structure:
```json
{
  "surgeries": [
    {
      "surgery_name": "Surgery Name",
      "category": "Surgical Category",
      "complications": [
        {
          "name": "Complication Name",
          "etiology": "Pathophysiology explanation",
          "risk_factors": "Risk factors list",
          "diagnostic_criteria": "Diagnostic signs and tests",
          "protocol": "Step 1: ... Step 2: ...",
          "references": ["URL1", "URL2"]
        }
      ]
    }
  ]
}
```

## ğŸŒ Deployment

### Streamlit Cloud

1. Push code to GitHub
2. Go to [share.streamlit.io](https://share.streamlit.io)
3. Connect your repository
4. Add secrets in app settings:
```toml
GOOGLE_API_KEY = "your_api_key_here"
```

5. Deploy!

**Note:** Update the API key variable in `streamlit_app.py` from `GOOGLE_API_KEY` to match Streamlit secrets.

## ğŸ” Technical Highlights

### RAG Pipeline

The system implements a sophisticated RAG pipeline:

1. **Document Preparation**: Concatenates all clinical fields (etiology, risk factors, diagnostics, protocol) for comprehensive context
2. **Chunking**: No chunking applied (documents are already atomic units)
3. **Embedding**: 384-dimensional vectors via sentence-transformers
4. **Retrieval**: Top-3 most similar documents using FAISS
5. **Generation**: Structured response with clinical sections

### LangChain LCEL

Uses LangChain Expression Language for clean, composable chains:
```python
rag_chain = (
    {
        "context": itemgetter("question") | retriever,
        "question": itemgetter("question"),
    }
    | prompt
    | llm
    | StrOutputParser()
)
```

### Prompt Engineering

System prompt ensures:
- âœ… Responses grounded only in provided context
- âœ… Structured Markdown formatting
- âœ… Clinical section organization
- âœ… Source attribution

## ğŸ“ Use Cases

- **Medical Students**: Learning surgical complication management
- **Residents**: Quick reference during clinical rounds
- **Surgeons**: Evidence-based protocol refresher
- **Researchers**: Clinical decision support system prototype
- **Educators**: Teaching tool for surgical complications

## âš ï¸ Disclaimer

**This application is for educational and research purposes only.**

- Not intended for real clinical use
- Not a substitute for professional medical judgment
- Not HIPAA compliant
- Always consult qualified healthcare professionals for medical decisions

## ğŸ¤ Contributing

Contributions are welcome! Please:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- **Google Gemini** for the powerful LLM API
- **LangChain** for the RAG framework
- **HuggingFace** for free embedding models
- **Streamlit** for the excellent UI framework
- **FAISS** for efficient vector search
- **Ministry of Health & Family Welfare (MoHFW)** for treatment guidelines


## ğŸš« PART 2: What NOT to Upload

**Delete or move these before uploading:**

1. âŒ `.env` file (contains your API key)
2. âŒ `venv/` or `env/` folder
3. âŒ `__pycache__/` folders
4. âŒ Any `.pyc` files
5. âŒ Any test data files

**Your final upload folder should contain ONLY:**
```
surgical-complication-assistant/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ai_engine.py
â”‚   â”œâ”€â”€ data_loader.py
â”‚   â””â”€â”€ vectorstore_manager.py
â”œâ”€â”€ data/
â”‚   â””â”€â”€ surgical_knowledge.json
â”œâ”€â”€ .streamlit/
â”‚   â””â”€â”€ config.toml
â”œâ”€â”€ streamlit_app.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env.example
â”œâ”€â”€ .gitignore

â””â”€â”€ README.md
